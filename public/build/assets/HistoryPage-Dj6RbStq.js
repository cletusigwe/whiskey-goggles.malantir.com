import{r as c,j as s,S as i}from"./app-DjZ1ADAr.js";import{c as x,A as j,B as n,t as l}from"./AppLayout-CNydKexg.js";import{C as b,a as w,b as g}from"./card-xFqZ6SGT.js";import{X as k,S,I as C}from"./input-D5LL_5KV.js";import{P as I}from"./plus-BheyByVk.js";/* empty css            *//**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _=[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]],q=x("RefreshCw",_);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const L=[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]],E=x("SquarePen",L),$=({images:r})=>{const[t,u]=c.useState(""),[p,o]=c.useState([]);c.useEffect(()=>{o(r)},[r]),c.useEffect(()=>{if(t.trim()==="")o(r);else{const e=r.filter(a=>a.name.toLowerCase().includes(t.toLowerCase())||a.unique_name.toLowerCase().includes(t.toLowerCase()));o(e)}},[t,r]);const m=e=>e.replace(/_/g," ").trim(),f=e=>new Date(e).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"}),d=p.filter(e=>{const a=e&&typeof e.id=="number"&&typeof e.whiskey_id=="number"&&typeof e.unique_name=="string";return a||console.warn("Invalid image entry:",e),a}),v=e=>{sessionStorage.setItem("selectedWhiskey",JSON.stringify({id:e.whiskey_id,unique_name:e.unique_name,name:e.name,image:e.image})),e.image&&sessionStorage.setItem("capturedImage",e.image),i.visit(`/edit?id=${e.whiskey_id}&image_id=${e.id}`)},N=e=>{const a=e.image||sessionStorage.getItem("capturedImage")||"";if(!a){l.error("No image available",{description:"Cannot reclassify without an image."});return}sessionStorage.setItem("capturedImage",a),i.post("/classify",{image:a,whiskey:e.unique_name},{onSuccess:()=>{l.success("Whiskey reclassified",{description:`Reclassifying ${m(e.unique_name)}.`}),i.visit("/results")},onError:y=>{l.error("Reclassification failed",{description:Object.values(y).join(", ")})}})},h=()=>{sessionStorage.removeItem("selectedWhiskey"),sessionStorage.removeItem("capturedImage"),i.visit("/")};return s.jsx(j,{title:"History",children:s.jsxs("main",{className:"flex min-h-screen flex-col bg-amber-50",children:[s.jsxs("header",{className:"flex items-center border-b border-amber-200 p-4",children:[s.jsx(n,{variant:"ghost",size:"icon",onClick:()=>i.visit("/"),className:"cursor-pointer text-amber-800",children:s.jsx(k,{className:"h-6 w-6"})}),s.jsx("h1",{className:"flex-1 text-center text-xl font-semibold text-amber-900",children:"Inventory History"}),s.jsx(n,{variant:"ghost",size:"icon",onClick:h,className:"cursor-pointer text-amber-800",children:s.jsx(I,{className:"h-5 w-5"})})]}),s.jsx("div",{className:"p-4",children:s.jsxs("div",{className:"mx-auto w-full max-w-md",children:[s.jsx("div",{className:"mb-4",children:s.jsxs("div",{className:"relative",children:[s.jsx(S,{className:"absolute top-1/2 left-3 h-4 w-4 -translate-y-1/2 transform text-amber-600"}),s.jsx(C,{type:"text",placeholder:"Search history...",value:t,onChange:e=>u(e.target.value),className:"border-amber-300 bg-white pl-9"})]})}),d.length===0?s.jsxs("div",{className:"p-8 text-center",children:[s.jsx("p",{className:"mb-4 text-amber-700",children:t?"No images match your search.":"No image history yet."}),s.jsxs(n,{className:"cursor-pointer bg-amber-600 text-white hover:bg-amber-700",onClick:h,children:[s.jsx(b,{className:"mr-2 h-5 w-5"}),"Scan a Whiskey"]})]}):s.jsx("div",{className:"space-y-4",children:d.map(e=>s.jsx(w,{className:"overflow-hidden",children:s.jsx(g,{className:"p-0",children:s.jsxs("div",{className:"flex items-center",children:[s.jsx("div",{className:"relative h-24 w-20 flex-shrink-0",children:s.jsx("img",{src:e.image||"/placeholder.svg",alt:e.name,className:"h-full w-full object-cover"})}),s.jsxs("div",{className:"flex-1 p-3",children:[s.jsx("h3",{className:"font-medium text-amber-900",children:m(e.unique_name)}),s.jsx("p",{className:"text-sm text-amber-600",children:e.name}),s.jsx("p",{className:"text-sm text-amber-600",children:f(e.created_at)})]}),s.jsxs("div",{className:"flex flex-col gap-2 pr-2",children:[s.jsxs(n,{variant:"outline",size:"sm",className:"cursor-pointer text-xs",onClick:()=>v(e),children:[s.jsx(E,{className:"mr-1 h-3 w-3"}),"Edit"]}),s.jsxs(n,{variant:"outline",size:"sm",className:"cursor-pointer text-xs",onClick:()=>N(e),children:[s.jsx(q,{className:"mr-1 h-3 w-3"}),"Reclassify"]})]})]})})},e.id))})]})})]})})};export{$ as default};

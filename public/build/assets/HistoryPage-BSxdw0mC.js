import{r as n,j as e,S as i}from"./app-Co2BVx7r.js";import{c as h,A as g,B as c,t as l}from"./AppLayout-_8uAItZ8.js";import{C as b,a as y,b as S}from"./card-CVmUs0hv.js";import{X as C,S as I,I as w}from"./input-DNFwhS7r.js";import{P as _}from"./plus-BPrGwF9q.js";/* empty css            *//**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const L=[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]],H=h("RefreshCw",L);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const k=[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]],q=h("SquarePen",k),D=({history:r})=>{const[t,p]=n.useState(""),[u,o]=n.useState([]);n.useEffect(()=>{o(r)},[r]),n.useEffect(()=>{if(t.trim()==="")o(r);else{const s=r.filter(a=>a.name.toLowerCase().includes(t.toLowerCase())||a.spirit_type.toLowerCase().includes(t.toLowerCase()));o(s)}},[t,r]);const m=s=>s.replace(/_/g," ").trim(),f=s=>new Date(s).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"}),d=u.filter(s=>{const a=s&&typeof s.id=="number"&&typeof s.unique_name=="string";return a||console.warn("Invalid whiskey entry:",s),a}),v=s=>{sessionStorage.setItem("selectedWhiskey",JSON.stringify(s)),s.image&&sessionStorage.setItem("capturedImage",s.image),i.visit("/edit")},N=s=>{const a=s.image||sessionStorage.getItem("capturedImage")||"";if(!a){l.error("No image available",{description:"Cannot reclassify without an image."});return}sessionStorage.setItem("capturedImage",a),i.post("/classify",{image:a,whiskey:s.unique_name},{onSuccess:()=>{l.success("Whiskey reclassified",{description:`Reclassifying ${m(s.unique_name)}.`}),i.visit("/results")},onError:j=>{l.error("Reclassification failed",{description:Object.values(j).join(", ")})}})},x=()=>{sessionStorage.removeItem("selectedWhiskey"),sessionStorage.removeItem("capturedImage"),i.visit("/")};return e.jsx(g,{title:"History",children:e.jsxs("main",{className:"flex min-h-screen flex-col bg-amber-50",children:[e.jsxs("header",{className:"flex items-center border-b border-amber-200 p-4",children:[e.jsx(c,{variant:"ghost",size:"icon",onClick:()=>i.visit("/"),className:"cursor-pointer text-amber-800",children:e.jsx(C,{className:"h-6 w-6"})}),e.jsx("h1",{className:"flex-1 text-center text-xl font-semibold text-amber-900",children:"Inventory History"}),e.jsx(c,{variant:"ghost",size:"icon",onClick:x,className:"cursor-pointer text-amber-800",children:e.jsx(_,{className:"h-5 w-5"})})]}),e.jsx("div",{className:"p-4",children:e.jsxs("div",{className:"mx-auto w-full max-w-md",children:[e.jsx("div",{className:"mb-4",children:e.jsxs("div",{className:"relative",children:[e.jsx(I,{className:"absolute top-1/2 left-3 h-4 w-4 -translate-y-1/2 transform text-amber-600"}),e.jsx(w,{type:"text",placeholder:"Search history...",value:t,onChange:s=>p(s.target.value),className:"border-amber-300 bg-white pl-9"})]})}),d.length===0?e.jsxs("div",{className:"p-8 text-center",children:[e.jsx("p",{className:"mb-4 text-amber-700",children:t?"No whiskeys match your search.":"No whiskey history yet."}),e.jsxs(c,{className:"cursor-pointer bg-amber-600 text-white hover:bg-amber-700",onClick:x,children:[e.jsx(b,{className:"mr-2 h-5 w-5"}),"Scan a Whiskey"]})]}):e.jsx("div",{className:"space-y-4",children:d.map(s=>e.jsx(y,{className:"overflow-hidden",children:e.jsx(S,{className:"p-0",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"relative h-24 w-20 flex-shrink-0",children:e.jsx("img",{src:s.image||"/placeholder.svg",alt:s.name,className:"h-full w-full object-cover"})}),e.jsxs("div",{className:"flex-1 p-3",children:[e.jsx("h3",{className:"font-medium text-amber-900",children:m(s.unique_name)}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("p",{className:"text-amber-700",children:["Stock: ",s.stock]}),e.jsxs("span",{className:"text-xs text-amber-600",children:["• ",s.size,"ml • ",s.proof," proof"]})]}),e.jsx("p",{className:"text-sm text-amber-600",children:f(s.date)})]}),e.jsxs("div",{className:"flex flex-col gap-2 pr-2",children:[e.jsxs(c,{variant:"outline",size:"sm",className:"cursor-pointer text-xs",onClick:()=>v(s),children:[e.jsx(q,{className:"mr-1 h-3 w-3"}),"Edit"]}),e.jsxs(c,{variant:"outline",size:"sm",className:"cursor-pointer text-xs",onClick:()=>N(s),children:[e.jsx(H,{className:"mr-1 h-3 w-3"}),"Reclassify"]})]})]})})},s.id))})]})})]})})};export{D as default};

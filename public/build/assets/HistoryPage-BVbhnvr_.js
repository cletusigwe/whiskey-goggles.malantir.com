import{r as s,j as a,S as E}from"./app-BPVNxkb9.js";import{u as G,c as z,b as Le,d as F,i as We,f as Ue,P as w,e as A,h as Ge,R as ze,g as qe,F as He,D as Ve}from"./Combination-C2vUFFar.js";import{c as q,u as C,d as Be,e as Ye,a as N,f as H,A as Ke,B as _,t as $}from"./AppLayout-m4WobgZk.js";import{X as Xe,S as Ze,C as Je,a as Qe,b as et}from"./card-BrP005gc.js";import{I as tt}from"./input-CnWFgTOB.js";import{D as at}from"./download-CvqpisOq.js";/* empty css            *//**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ot=[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]],nt=q("SquarePen",ot);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rt=[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}]],st=q("Trash",rt);function it(e,t){return s.useReducer((o,n)=>t[o][n]??o,e)}var P=e=>{const{present:t,children:o}=e,n=lt(t),r=typeof o=="function"?o({present:n.isPresent}):s.Children.only(o),i=C(n.ref,ct(r));return typeof o=="function"||n.isPresent?s.cloneElement(r,{ref:i}):null};P.displayName="Presence";function lt(e){const[t,o]=s.useState(),n=s.useRef(null),r=s.useRef(e),i=s.useRef("none"),c=e?"mounted":"unmounted",[m,u]=it(c,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}});return s.useEffect(()=>{const l=O(n.current);i.current=m==="mounted"?l:"none"},[m]),G(()=>{const l=n.current,f=r.current;if(f!==e){const y=i.current,g=O(l);e?u("MOUNT"):g==="none"||(l==null?void 0:l.display)==="none"?u("UNMOUNT"):u(f&&y!==g?"ANIMATION_OUT":"UNMOUNT"),r.current=e}},[e,u]),G(()=>{if(t){let l;const f=t.ownerDocument.defaultView??window,x=g=>{const M=O(n.current).includes(g.animationName);if(g.target===t&&M&&(u("ANIMATION_END"),!r.current)){const k=t.style.animationFillMode;t.style.animationFillMode="forwards",l=f.setTimeout(()=>{t.style.animationFillMode==="forwards"&&(t.style.animationFillMode=k)})}},y=g=>{g.target===t&&(i.current=O(n.current))};return t.addEventListener("animationstart",y),t.addEventListener("animationcancel",x),t.addEventListener("animationend",x),()=>{f.clearTimeout(l),t.removeEventListener("animationstart",y),t.removeEventListener("animationcancel",x),t.removeEventListener("animationend",x)}}else u("ANIMATION_END")},[t,u]),{isPresent:["mounted","unmountSuspended"].includes(m),ref:s.useCallback(l=>{n.current=l?getComputedStyle(l):null,o(l)},[])}}function O(e){return(e==null?void 0:e.animationName)||"none"}function ct(e){var n,r;let t=(n=Object.getOwnPropertyDescriptor(e.props,"ref"))==null?void 0:n.get,o=t&&"isReactWarning"in t&&t.isReactWarning;return o?e.ref:(t=(r=Object.getOwnPropertyDescriptor(e,"ref"))==null?void 0:r.get,o=t&&"isReactWarning"in t&&t.isReactWarning,o?e.props.ref:e.props.ref||e.ref)}var S="Dialog",[V,B]=z(S),[dt,p]=V(S),Y=e=>{const{__scopeDialog:t,children:o,open:n,defaultOpen:r,onOpenChange:i,modal:c=!0}=e,m=s.useRef(null),u=s.useRef(null),[l,f]=Le({prop:n,defaultProp:r??!1,onChange:i,caller:S});return a.jsx(dt,{scope:t,triggerRef:m,contentRef:u,contentId:F(),titleId:F(),descriptionId:F(),open:l,onOpenChange:f,onOpenToggle:s.useCallback(()=>f(x=>!x),[f]),modal:c,children:o})};Y.displayName=S;var K="DialogTrigger",X=s.forwardRef((e,t)=>{const{__scopeDialog:o,...n}=e,r=p(K,o),i=C(t,r.triggerRef);return a.jsx(w.button,{type:"button","aria-haspopup":"dialog","aria-expanded":r.open,"aria-controls":r.contentId,"data-state":U(r.open),...n,ref:i,onClick:A(e.onClick,r.onOpenToggle)})});X.displayName=K;var L="DialogPortal",[ut,Z]=V(L,{forceMount:void 0}),J=e=>{const{__scopeDialog:t,forceMount:o,children:n,container:r}=e,i=p(L,t);return a.jsx(ut,{scope:t,forceMount:o,children:s.Children.map(n,c=>a.jsx(P,{present:o||i.open,children:a.jsx(Ue,{asChild:!0,container:r,children:c})}))})};J.displayName=L;var I="DialogOverlay",Q=s.forwardRef((e,t)=>{const o=Z(I,e.__scopeDialog),{forceMount:n=o.forceMount,...r}=e,i=p(I,e.__scopeDialog);return i.modal?a.jsx(P,{present:n||i.open,children:a.jsx(ft,{...r,ref:t})}):null});Q.displayName=I;var mt=Be("DialogOverlay.RemoveScroll"),ft=s.forwardRef((e,t)=>{const{__scopeDialog:o,...n}=e,r=p(I,o);return a.jsx(ze,{as:mt,allowPinchZoom:!0,shards:[r.contentRef],children:a.jsx(w.div,{"data-state":U(r.open),...n,ref:t,style:{pointerEvents:"auto",...n.style}})})}),D="DialogContent",ee=s.forwardRef((e,t)=>{const o=Z(D,e.__scopeDialog),{forceMount:n=o.forceMount,...r}=e,i=p(D,e.__scopeDialog);return a.jsx(P,{present:n||i.open,children:i.modal?a.jsx(pt,{...r,ref:t}):a.jsx(gt,{...r,ref:t})})});ee.displayName=D;var pt=s.forwardRef((e,t)=>{const o=p(D,e.__scopeDialog),n=s.useRef(null),r=C(t,o.contentRef,n);return s.useEffect(()=>{const i=n.current;if(i)return Ge(i)},[]),a.jsx(te,{...e,ref:r,trapFocus:o.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:A(e.onCloseAutoFocus,i=>{var c;i.preventDefault(),(c=o.triggerRef.current)==null||c.focus()}),onPointerDownOutside:A(e.onPointerDownOutside,i=>{const c=i.detail.originalEvent,m=c.button===0&&c.ctrlKey===!0;(c.button===2||m)&&i.preventDefault()}),onFocusOutside:A(e.onFocusOutside,i=>i.preventDefault())})}),gt=s.forwardRef((e,t)=>{const o=p(D,e.__scopeDialog),n=s.useRef(!1),r=s.useRef(!1);return a.jsx(te,{...e,ref:t,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:i=>{var c,m;(c=e.onCloseAutoFocus)==null||c.call(e,i),i.defaultPrevented||(n.current||(m=o.triggerRef.current)==null||m.focus(),i.preventDefault()),n.current=!1,r.current=!1},onInteractOutside:i=>{var u,l;(u=e.onInteractOutside)==null||u.call(e,i),i.defaultPrevented||(n.current=!0,i.detail.originalEvent.type==="pointerdown"&&(r.current=!0));const c=i.target;((l=o.triggerRef.current)==null?void 0:l.contains(c))&&i.preventDefault(),i.detail.originalEvent.type==="focusin"&&r.current&&i.preventDefault()}})}),te=s.forwardRef((e,t)=>{const{__scopeDialog:o,trapFocus:n,onOpenAutoFocus:r,onCloseAutoFocus:i,...c}=e,m=p(D,o),u=s.useRef(null),l=C(t,u);return qe(),a.jsxs(a.Fragment,{children:[a.jsx(He,{asChild:!0,loop:!0,trapped:n,onMountAutoFocus:r,onUnmountAutoFocus:i,children:a.jsx(Ve,{role:"dialog",id:m.contentId,"aria-describedby":m.descriptionId,"aria-labelledby":m.titleId,"data-state":U(m.open),...c,ref:l,onDismiss:()=>m.onOpenChange(!1)})}),a.jsxs(a.Fragment,{children:[a.jsx(ht,{titleId:m.titleId}),a.jsx(Nt,{contentRef:u,descriptionId:m.descriptionId})]})]})}),W="DialogTitle",ae=s.forwardRef((e,t)=>{const{__scopeDialog:o,...n}=e,r=p(W,o);return a.jsx(w.h2,{id:r.titleId,...n,ref:t})});ae.displayName=W;var oe="DialogDescription",ne=s.forwardRef((e,t)=>{const{__scopeDialog:o,...n}=e,r=p(oe,o);return a.jsx(w.p,{id:r.descriptionId,...n,ref:t})});ne.displayName=oe;var re="DialogClose",se=s.forwardRef((e,t)=>{const{__scopeDialog:o,...n}=e,r=p(re,o);return a.jsx(w.button,{type:"button",...n,ref:t,onClick:A(e.onClick,()=>r.onOpenChange(!1))})});se.displayName=re;function U(e){return e?"open":"closed"}var ie="DialogTitleWarning",[xt,le]=We(ie,{contentName:D,titleName:W,docsSlug:"dialog"}),ht=({titleId:e})=>{const t=le(ie),o=`\`${t.contentName}\` requires a \`${t.titleName}\` for the component to be accessible for screen reader users.

If you want to hide the \`${t.titleName}\`, you can wrap it with our VisuallyHidden component.

For more information, see https://radix-ui.com/primitives/docs/components/${t.docsSlug}`;return s.useEffect(()=>{e&&(document.getElementById(e)||console.error(o))},[o,e]),null},vt="DialogDescriptionWarning",Nt=({contentRef:e,descriptionId:t})=>{const n=`Warning: Missing \`Description\` or \`aria-describedby={undefined}\` for {${le(vt).contentName}}.`;return s.useEffect(()=>{var i;const r=(i=e.current)==null?void 0:i.getAttribute("aria-describedby");t&&r&&(document.getElementById(t)||console.warn(n))},[n,e,t]),null},Dt=Y,yt=X,At=J,jt=Q,Ct=ee,bt=ae,_t=ne,ce=se,de="AlertDialog",[wt,Yt]=z(de,[B]),h=B(),ue=e=>{const{__scopeAlertDialog:t,...o}=e,n=h(t);return a.jsx(Dt,{...n,...o,modal:!0})};ue.displayName=de;var Rt="AlertDialogTrigger",Et=s.forwardRef((e,t)=>{const{__scopeAlertDialog:o,...n}=e,r=h(o);return a.jsx(yt,{...r,...n,ref:t})});Et.displayName=Rt;var Ot="AlertDialogPortal",me=e=>{const{__scopeAlertDialog:t,...o}=e,n=h(t);return a.jsx(At,{...n,...o})};me.displayName=Ot;var It="AlertDialogOverlay",fe=s.forwardRef((e,t)=>{const{__scopeAlertDialog:o,...n}=e,r=h(o);return a.jsx(jt,{...r,...n,ref:t})});fe.displayName=It;var j="AlertDialogContent",[Pt,St]=wt(j),Tt=Ye("AlertDialogContent"),pe=s.forwardRef((e,t)=>{const{__scopeAlertDialog:o,children:n,...r}=e,i=h(o),c=s.useRef(null),m=C(t,c),u=s.useRef(null);return a.jsx(xt,{contentName:j,titleName:ge,docsSlug:"alert-dialog",children:a.jsx(Pt,{scope:o,cancelRef:u,children:a.jsxs(Ct,{role:"alertdialog",...i,...r,ref:m,onOpenAutoFocus:A(r.onOpenAutoFocus,l=>{var f;l.preventDefault(),(f=u.current)==null||f.focus({preventScroll:!0})}),onPointerDownOutside:l=>l.preventDefault(),onInteractOutside:l=>l.preventDefault(),children:[a.jsx(Tt,{children:n}),a.jsx(kt,{contentRef:c})]})})})});pe.displayName=j;var ge="AlertDialogTitle",xe=s.forwardRef((e,t)=>{const{__scopeAlertDialog:o,...n}=e,r=h(o);return a.jsx(bt,{...r,...n,ref:t})});xe.displayName=ge;var he="AlertDialogDescription",ve=s.forwardRef((e,t)=>{const{__scopeAlertDialog:o,...n}=e,r=h(o);return a.jsx(_t,{...r,...n,ref:t})});ve.displayName=he;var Mt="AlertDialogAction",Ne=s.forwardRef((e,t)=>{const{__scopeAlertDialog:o,...n}=e,r=h(o);return a.jsx(ce,{...r,...n,ref:t})});Ne.displayName=Mt;var De="AlertDialogCancel",ye=s.forwardRef((e,t)=>{const{__scopeAlertDialog:o,...n}=e,{cancelRef:r}=St(De,o),i=h(o),c=C(t,r);return a.jsx(ce,{...i,...n,ref:c})});ye.displayName=De;var kt=({contentRef:e})=>{const t=`\`${j}\` requires a description for the component to be accessible for screen reader users.

You can add a description to the \`${j}\` by passing a \`${he}\` component as a child, which also benefits sighted users by adding visible context to the dialog.

Alternatively, you can use your own component as a description by assigning it an \`id\` and passing the same value to the \`aria-describedby\` prop in \`${j}\`. If the description is confusing or duplicative for sighted users, you can use the \`@radix-ui/react-visually-hidden\` primitive as a wrapper around your description component.

For more information, see https://radix-ui.com/primitives/docs/components/alert-dialog`;return s.useEffect(()=>{var n;document.getElementById((n=e.current)==null?void 0:n.getAttribute("aria-describedby"))||console.warn(t)},[t,e]),null},Ft=ue,$t=me,Ae=fe,je=pe,Ce=Ne,be=ye,_e=xe,we=ve;const Lt=Ft,Wt=$t,Re=s.forwardRef(({className:e,...t},o)=>a.jsx(Ae,{className:N("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",e),...t,ref:o}));Re.displayName=Ae.displayName;const Ee=s.forwardRef(({className:e,...t},o)=>a.jsxs(Wt,{children:[a.jsx(Re,{}),a.jsx(je,{ref:o,className:N("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",e),...t})]}));Ee.displayName=je.displayName;const Oe=({className:e,...t})=>a.jsx("div",{className:N("flex flex-col space-y-2 text-center sm:text-left",e),...t});Oe.displayName="AlertDialogHeader";const Ie=({className:e,...t})=>a.jsx("div",{className:N("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",e),...t});Ie.displayName="AlertDialogFooter";const Pe=s.forwardRef(({className:e,...t},o)=>a.jsx(_e,{ref:o,className:N("text-lg font-semibold",e),...t}));Pe.displayName=_e.displayName;const Se=s.forwardRef(({className:e,...t},o)=>a.jsx(we,{ref:o,className:N("text-sm text-muted-foreground",e),...t}));Se.displayName=we.displayName;const Te=s.forwardRef(({className:e,...t},o)=>a.jsx(Ce,{ref:o,className:N(H(),e),...t}));Te.displayName=Ce.displayName;const Me=s.forwardRef(({className:e,...t},o)=>a.jsx(be,{ref:o,className:N(H({variant:"outline"}),"mt-2 sm:mt-0",e),...t}));Me.displayName=be.displayName;const Kt=({images:e})=>{const[t,o]=s.useState(""),[n,r]=s.useState(e),[i,c]=s.useState([]),[m,u]=s.useState(!1),[l,f]=s.useState(null);s.useEffect(()=>{r(e)},[e]),s.useEffect(()=>{if(t.trim()==="")c(n);else{const d=n.filter(v=>v.name.toLowerCase().includes(t.toLowerCase())||v.unique_name.toLowerCase().includes(t.toLowerCase()));c(d)}},[t,n]);const x=d=>d.replace(/_/g," ").trim(),y=d=>new Date(d).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"}),g=i.filter(d=>{const v=d&&typeof d.id=="number"&&typeof d.whiskey_id=="number"&&typeof d.unique_name=="string";return v||console.warn("Invalid image entry:",d),v}),T=d=>{E.visit(`/edit/${d.id}`)},M=d=>{f(d),u(!0)},k=()=>{l&&E.delete(`/images/${l}`,{onSuccess:()=>{r(n.filter(d=>d.id!==l)),$.success("Entry deleted successfully")},onError:()=>{$.error("Failed to delete entry")}}),u(!1)},ke=()=>{if(n.length===0){$.info("No images to export");return}const v=`data:text/csv;charset=utf-8,image_url,whiskey_unique_name
`+n.map(R=>[R.image||"",R.unique_name]).map(R=>R.map($e=>`"${$e}"`).join(",")).join(`
`),Fe=encodeURI(v),b=document.createElement("a");b.setAttribute("href",Fe),b.setAttribute("download","whiskey_dataset.csv"),document.body.appendChild(b),b.click(),document.body.removeChild(b)};return a.jsxs(Ke,{title:"History",children:[a.jsxs("main",{className:"flex min-h-screen flex-col bg-amber-50",children:[a.jsxs("header",{className:"flex flex-col items-center gap-2 border-b border-amber-200 p-4 sm:flex-row sm:justify-between",children:[a.jsx(_,{variant:"ghost",size:"icon",onClick:()=>E.visit("/"),className:"cursor-pointer text-amber-800",children:a.jsx(Xe,{className:"h-6 w-6"})}),a.jsx("h1",{className:"text-lg font-semibold text-amber-900 sm:text-xl",children:"Inventory History"}),a.jsxs(_,{size:"sm",onClick:ke,className:"flex cursor-pointer items-center gap-2 bg-amber-600 text-white hover:bg-amber-700",children:[a.jsx(at,{className:"h-4 w-4 sm:h-5 sm:w-5"}),a.jsx("span",{className:"hidden sm:inline",children:"Export New Dataset"}),a.jsx("span",{className:"sm:hidden",children:"Export Dataset"})]})]}),a.jsx("div",{className:"p-4",children:a.jsxs("div",{className:"mx-auto w-full max-w-md",children:[a.jsx("div",{className:"mb-4",children:a.jsxs("div",{className:"relative w-full",children:[a.jsx(Ze,{className:"absolute top-1/2 left-3 h-4 w-4 -translate-y-1/2 transform text-amber-600"}),a.jsx(tt,{type:"text",placeholder:"Search history...",value:t,onChange:d=>o(d.target.value),className:"w-full border-amber-300 bg-white pl-9 sm:pl-10"})]})}),g.length===0?a.jsxs("div",{className:"p-6 text-center sm:p-8",children:[a.jsx("p",{className:"mb-4 text-sm text-amber-700 sm:text-base",children:t?"No images match your search.":"No image history yet."}),a.jsxs(_,{size:"sm",className:"cursor-pointer bg-amber-600 text-white hover:bg-amber-700",onClick:()=>E.visit("/"),children:[a.jsx(Je,{className:"mr-2 h-4 w-4"}),"Scan a Whiskey"]})]}):a.jsx("div",{className:"space-y-4",children:g.map(d=>a.jsx(Qe,{className:"overflow-hidden",children:a.jsx(et,{className:"p-0",children:a.jsxs("div",{className:"flex items-center",children:[a.jsx("div",{className:"relative h-20 w-16 flex-shrink-0 sm:h-24 sm:w-20",children:a.jsx("img",{src:d.image||"/placeholder.svg",alt:d.name,className:"h-full w-full object-cover"})}),a.jsxs("div",{className:"flex-1 p-2 sm:p-3",children:[a.jsx("h3",{className:"text-sm font-medium text-amber-900 sm:text-base",children:x(d.unique_name)}),a.jsx("p",{className:"text-xs text-amber-600 sm:text-sm",children:d.name}),a.jsx("p",{className:"text-xs text-amber-600 sm:text-sm",children:y(d.created_at)})]}),a.jsxs("div",{className:"flex flex-col gap-2 pr-2",children:[a.jsxs(_,{variant:"outline",size:"sm",className:"cursor-pointer text-xs",onClick:()=>T(d),children:[a.jsx(nt,{className:"mr-1 h-3 w-3"}),"Edit"]}),a.jsxs(_,{variant:"outline",size:"sm",className:"cursor-pointer text-xs",onClick:()=>M(d.id),children:[a.jsx(st,{className:"mr-1 h-3 w-3"}),"Delete"]})]})]})})},d.id))})]})})]}),a.jsx(Lt,{open:m,onOpenChange:u,children:a.jsxs(Ee,{children:[a.jsxs(Oe,{children:[a.jsx(Pe,{children:"Delete Entry"}),a.jsx(Se,{children:"Are you sure you want to delete this entry? This action cannot be undone."})]}),a.jsxs(Ie,{children:[a.jsx(Me,{onClick:()=>u(!1),children:"Cancel"}),a.jsx(Te,{onClick:k,children:"Delete"})]})]})})]})};export{Kt as default};

import{r as o,j as e,S as l}from"./app-BciQzvW6.js";import{c as f,A as k,B as n,t as i}from"./AppLayout-D3ovcFoi.js";import{X as S,S as I,C as L,a as _,b as E}from"./card-A3fazVjq.js";import{I as R}from"./input-BA5lnM8V.js";import{P as q}from"./plus-JS6GsLZO.js";/* empty css            *//**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const M=[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]],z=f("RefreshCw",M);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const H=[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]],P=f("SquarePen",H),B=({images:r})=>{const[t,p]=o.useState(""),[v,m]=o.useState([]),[N,b]=o.useState(null);o.useEffect(()=>{m(r)},[r]),o.useEffect(()=>{if(t.trim()==="")m(r);else{const s=r.filter(a=>a.name.toLowerCase().includes(t.toLowerCase())||a.unique_name.toLowerCase().includes(t.toLowerCase()));m(s)}},[t,r]);const j=s=>s.replace(/_/g," ").trim(),d=async s=>{try{const a=await fetch(`${s}`);if(!a.ok)throw new Error(`Failed to fetch ${s}`);const C=await a.blob(),c=new FileReader;c.onload=()=>{const u=c.result;b(u),sessionStorage.setItem("capturedImage",u)},c.onerror=()=>{i.error("Failed to load image",{description:`Could not load ${s}.`})},c.readAsDataURL(C)}catch(a){i.error("Error loading default image",{description:a instanceof Error?a.message:"An unknown error occurred"})}},y=s=>new Date(s).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"}),h=v.filter(s=>{const a=s&&typeof s.id=="number"&&typeof s.whiskey_id=="number"&&typeof s.unique_name=="string";return a||console.warn("Invalid image entry:",s),a}),w=s=>{const a=s.image;if(!a){i.error("No image available",{description:"Cannot reclassify without an image."});return}d(a),l.visit(`/edit/${s.id}`)},g=s=>{const a=s.image;if(!a){i.error("No image available",{description:"Cannot reclassify without an image."});return}d(a),N?l.visit("/results"):i.error("Reclassification failed",{description:"Image not found"})},x=()=>{sessionStorage.removeItem("selectedWhiskey"),sessionStorage.removeItem("capturedImage"),l.visit("/")};return e.jsx(k,{title:"History",children:e.jsxs("main",{className:"flex min-h-screen flex-col bg-amber-50",children:[e.jsxs("header",{className:"flex items-center border-b border-amber-200 p-4",children:[e.jsx(n,{variant:"ghost",size:"icon",onClick:()=>l.visit("/"),className:"cursor-pointer text-amber-800",children:e.jsx(S,{className:"h-6 w-6"})}),e.jsx("h1",{className:"flex-1 text-center text-xl font-semibold text-amber-900",children:"Inventory History"}),e.jsx(n,{variant:"ghost",size:"icon",onClick:x,className:"cursor-pointer text-amber-800",children:e.jsx(q,{className:"h-5 w-5"})})]}),e.jsx("div",{className:"p-4",children:e.jsxs("div",{className:"mx-auto w-full max-w-md",children:[e.jsx("div",{className:"mb-4",children:e.jsxs("div",{className:"relative",children:[e.jsx(I,{className:"absolute top-1/2 left-3 h-4 w-4 -translate-y-1/2 transform text-amber-600"}),e.jsx(R,{type:"text",placeholder:"Search history...",value:t,onChange:s=>p(s.target.value),className:"border-amber-300 bg-white pl-9"})]})}),h.length===0?e.jsxs("div",{className:"p-8 text-center",children:[e.jsx("p",{className:"mb-4 text-amber-700",children:t?"No images match your search.":"No image history yet."}),e.jsxs(n,{className:"cursor-pointer bg-amber-600 text-white hover:bg-amber-700",onClick:x,children:[e.jsx(L,{className:"mr-2 h-5 w-5"}),"Scan a Whiskey"]})]}):e.jsx("div",{className:"space-y-4",children:h.map(s=>e.jsx(_,{className:"overflow-hidden",children:e.jsx(E,{className:"p-0",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"relative h-24 w-20 flex-shrink-0",children:e.jsx("img",{src:s.image||"/placeholder.svg",alt:s.name,className:"h-full w-full object-cover"})}),e.jsxs("div",{className:"flex-1 p-3",children:[e.jsx("h3",{className:"font-medium text-amber-900",children:j(s.unique_name)}),e.jsx("p",{className:"text-sm text-amber-600",children:s.name}),e.jsx("p",{className:"text-sm text-amber-600",children:y(s.created_at)})]}),e.jsxs("div",{className:"flex flex-col gap-2 pr-2",children:[e.jsxs(n,{variant:"outline",size:"sm",className:"cursor-pointer text-xs",onClick:()=>w(s),children:[e.jsx(P,{className:"mr-1 h-3 w-3"}),"Edit"]}),e.jsxs(n,{variant:"outline",size:"sm",className:"cursor-pointer text-xs",onClick:()=>g(s),children:[e.jsx(z,{className:"mr-1 h-3 w-3"}),"Reclassify"]})]})]})})},s.id))})]})})]})})};export{B as default};
